#!/bin/bash

OUTPUT="/heritrix/output/wayback/cdx-index/sorted"
JAR="/heritrix/bin/hadoop-utils-0.0.1-jar-with-dependencies.jar"
CLASS="com.alexholmes.hadooputils.sort.Sort"
INPUT="/heritrix/output/wayback/cdx-index/2013*"
CDX="/heritrix/output/wayback/cdx-index/index.cdx"

hadoop fs -rmr "$OUTPUT/"
hadoop jar "$JAR" "$CLASS" --total-order 0.1 10000 10 "$INPUT/" "$OUTPUT/" && hadoop fs -cat "$OUTPUT/part-*" > "$CDX"
